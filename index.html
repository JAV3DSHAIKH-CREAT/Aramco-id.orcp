<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S019 - ARAMCO ID LOG</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>

<style>
:root{
    --dark-bg:#0f172a;
    --card-bg:#1e293b;
    --accent:#2563eb;
    --light:#e2e8f0;
    --muted:#94a3b8;
    --shadow:0 10px 25px rgba(0,0,0,0.4);
}

*{margin:0;padding:0;box-sizing:border-box}

body{
    font-family:'Poppins',sans-serif;
    background:var(--dark-bg);
    color:var(--light);
    height: 100vh;
    overflow: hidden;
}

header{
    position:relative;
    background:linear-gradient(135deg,#1e3a8a,#2563eb);
    padding: 20px;
    text-align:center;
    border-bottom-left-radius:30px;
    border-bottom-right-radius:30px;
    box-shadow:var(--shadow);
}

header h1{font-size:1.5rem;font-weight:600}
header p{font-size: 0.8rem; opacity:.8}

.logo{
    position:absolute;
    left:30px;
    top:50%;
    transform:translateY(-50%);
    width:60px;
    height:60px;
    object-fit:contain;
}

#showFullDataBtn{
    position:absolute;
    right:30px;
    top:50%;
    transform:translateY(-50%);
    padding:8px 12px;
    background:#22c55e;
    color:#0f172a;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
    font-size:0.85rem;
    box-shadow:var(--shadow);
}
#showFullDataBtn:hover{ background:#16a34a; }

.search-wrapper{
    max-width:500px;
    margin: 15px auto;
    position:relative;
    z-index: 10;
}

#mainSearch{
    width:100%;
    padding:12px 20px;
    border-radius:50px;
    border:1px solid #334155;
    font-size:0.9rem;
    outline:none;
    background:#1e293b;
    color:white;
    box-shadow:var(--shadow);
}

.suggestions{
    position:absolute;
    top:50px;left:0;right:0;
    background:#1e293b;
    border-radius:15px;
    max-height:200px;
    overflow-y:auto;
    display:none;
    box-shadow:var(--shadow);
    border:1px solid #334155;
}

.suggestion-item{
    padding:10px 20px;
    cursor:pointer;
    border-bottom:1px solid #334155;
    font-size:0.9rem;
}
.suggestion-item:hover{ background:#2563eb; }

.container {
    max-width: 95%;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;
    height: 70vh;
    gap: 15px;
    justify-content: flex-start;
    align-content: center;
}

.section-box {
    background: var(--card-bg);
    width: 48%;
    padding: 15px;
    border-radius: 15px;
    box-shadow: var(--shadow);
    border: 1px solid #334155;
}

.section-box h3{
    margin-bottom:12px;
    font-weight:700;
    font-size:1rem;
    color:#3b82f6;
    border-left:4px solid var(--accent);
    padding-left:10px;
}

.section-grid{
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:8px;
}

.info-card{
    background:#0f172a;
    padding:8px 12px;
    border-radius:10px;
    border:1px solid #334155;
}

.label{
    font-size:0.6rem;
    color:var(--muted);
    text-transform:uppercase;
    display:block;
}

.value{
    font-size:0.85rem;
    font-weight:500;
    word-break: break-all;
}

#statusMsg{
    text-align:center;
    margin-bottom:10px;
    font-size:.8rem;
    color:#22c55e;
}

footer{
    position:fixed;
    bottom:0;
    width:100%;
    text-align:center;
    padding:8px 0;
    background:#1e293b;
    color:var(--muted);
    font-size:0.75rem;
    box-shadow:var(--shadow);
}

/* Bottom Left Update Indicator */
.update-indicator{
    position:fixed;
    bottom:10px;
    left:15px;
    display:flex;
    align-items:center;
    gap:8px;
    font-size:0.75rem;
    background:#1e293b;
    padding:6px 12px;
    border-radius:20px;
    box-shadow:var(--shadow);
    border:1px solid #334155;
}

.green-dot{
    width:10px;
    height:10px;
    background:#22c55e;
    border-radius:50%;
    box-shadow:0 0 8px #22c55e;
}

#lastUpdated{
    color:#22c55e;
    font-weight:500;
}

@media(max-width:1000px){
    body { overflow-y: auto; height: auto; }
    .container { height: auto; flex-wrap: nowrap; align-content: stretch; }
    .section-box { width: 100%; }
}
</style>
</head>

<body>

<header>
    <img src="orcp.bmp" class="logo" alt="ORCP Logo">
    <h1>JAFFURAH - S019 ARAMCO ID DETAILS</h1>
    <p>PROFESSIONAL PERSONNEL DATABASE</p>
    <button id="showFullDataBtn">SHOW FULL DATA</button>
</header>

<div class="search-wrapper">
    <input type="text" id="mainSearch" placeholder="Search by FILE NO..." autocomplete="off">
    <div id="suggestions" class="suggestions"></div>
</div>

<div id="statusMsg">Connecting to Database...</div>
<div class="container" id="infoContainer"></div>

<footer>
    Created by MOHAMMAD JAVED SHAIKH (603660)
</footer>

<!-- Bottom Left Green Signal -->
<div class="update-indicator">
    <div class="green-dot"></div>
    <div id="lastUpdated">Checking update...</div>
</div>

<script>
const FILE_URL='S019-ARAMCO ID LOG.xlsx';
let database=[];

async function loadExcel(){
    const status=document.getElementById('statusMsg');
    try{
        const response=await fetch(FILE_URL);
        const arrayBuffer=await response.arrayBuffer();
        const workbook=XLSX.read(arrayBuffer,{type:'array'});
        const sheet=workbook.Sheets["ARAMCO ID LOG - S019"];
        const raw=XLSX.utils.sheet_to_json(sheet,{defval:""});

        database=raw.map(row=>{
            let clean={};
            for(let key in row){
                clean[key.trim().toUpperCase()]=row[key];
            }
            return clean;
        });

        status.innerHTML="✅ Data Loaded: "+database.length+" Records Found";

    }catch(err){
        status.innerHTML="❌ Error: Ensure Excel file is in same folder";
    }
}

async function getLastModified(){
    try{
        const response = await fetch(FILE_URL, { method: 'HEAD' });
        const lastModified = response.headers.get('Last-Modified');

        if(lastModified){
            const date = new Date(lastModified);
            const formatted = date.toLocaleString('en-GB');
            document.getElementById('lastUpdated').innerText =
                "Last Updated: " + formatted;
        }else{
            document.getElementById('lastUpdated').innerText =
                "Last Updated: Not Available";
        }
    }catch(err){
        document.getElementById('lastUpdated').innerText =
            "Update Info Error";
    }
}

window.onload = () => {
    loadExcel();
    getLastModified();
};
</script>

</body>
</html>
