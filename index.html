<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S019 - ARAMCO ID LOG Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>

<style>
:root{
--primary-gradient:linear-gradient(135deg,#004d40 0%,#00796b 100%);
--accent:#00bfa5;
--bg:#f0f2f5;
--card-bg:#ffffff;
--text-dark:#2d3436;
--text-light:#636e72;
--shadow:0 10px 30px rgba(0,0,0,0.08);
}

*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text-dark)}

header{
background:var(--primary-gradient);
color:white;
padding:60px 20px 80px;
text-align:center;
border-bottom-left-radius:50px;
border-bottom-right-radius:50px;
}
header h1{font-size:2rem;font-weight:600}
header p{opacity:.8}

.search-wrapper{
max-width:600px;
margin:-40px auto 40px;
padding:0 20px;
position:relative;
}
#mainSearch{
width:100%;
padding:20px 25px;
border-radius:100px;
border:none;
box-shadow:0 15px 35px rgba(0,0,0,0.15);
font-size:1rem;
outline:none;
}
.suggestions{
position:absolute;
top:75px;left:30px;right:30px;
background:white;
border-radius:15px;
box-shadow:var(--shadow);
max-height:300px;
overflow-y:auto;
display:none;
z-index:999;
}
.suggestion-item{
padding:15px 20px;
cursor:pointer;
border-bottom:1px solid #f1f1f1;
}
.suggestion-item:hover{background:#e0f2f1}

.container{
max-width:1200px;
margin:auto;
padding:0 20px 80px;
}

.section-box{
background:white;
margin-bottom:30px;
padding:25px;
border-radius:20px;
box-shadow:var(--shadow);
}
.section-box h3{
margin-bottom:20px;
font-weight:600;
color:#004d40;
border-left:5px solid var(--accent);
padding-left:10px;
}
.section-grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
gap:15px;
}
.info-card{
background:#fafafa;
padding:15px;
border-radius:15px;
border-top:4px solid var(--accent);
}
.label{
font-size:.7rem;
color:var(--text-light);
text-transform:uppercase;
font-weight:600;
}
.value{
font-size:.95rem;
font-weight:500;
margin-top:4px;
word-break:break-word;
}

#statusMsg{
text-align:center;
margin-bottom:20px;
font-size:.9rem;
color:var(--text-light);
}

@media(max-width:600px){
.section-grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<header>
<h1>S019 ARAMCO ID LOG</h1>
<p>DIGITAL PERSONNEL DATABASE</p>
</header>

<div class="search-wrapper">
<input type="text" id="mainSearch" placeholder="Search by Company..." autocomplete="off">
<div id="suggestions" class="suggestions"></div>
</div>

<div id="statusMsg">Loading Database...</div>

<div class="container">
<div id="infoContainer"></div>
</div>

<script>

const FILE_URL = 'S019-ARAMCO ID LOG.xlsx';
let database = [];

async function loadExcel(){
const status=document.getElementById('statusMsg');
try{
const response=await fetch(FILE_URL);
const arrayBuffer=await response.arrayBuffer();
const workbook=XLSX.read(arrayBuffer,{type:'array'});
const sheet=workbook.Sheets["ARAMCO ID LOG - S019"];
const raw=XLSX.utils.sheet_to_json(sheet,{defval:""});

database=raw.map(row=>{
let clean={};
for(let key in row){
clean[key.trim().toUpperCase()]=row[key];
}
return clean;
});

status.innerHTML="✅ Database Ready : "+database.length+" Records";

}catch(err){
status.innerHTML="❌ Error loading Excel file";
console.error(err);
}
}

const searchInput=document.getElementById('mainSearch');
const suggestBox=document.getElementById('suggestions');

searchInput.addEventListener('input',(e)=>{
const query=e.target.value.toLowerCase().trim();
suggestBox.innerHTML='';
if(query.length<1){suggestBox.style.display='none';return;}

const matches=database.filter(item=>
String(item['COMPANY']||"").toLowerCase().includes(query)
).slice(0,10);

if(matches.length>0){
suggestBox.style.display='block';
matches.forEach(item=>{
const div=document.createElement('div');
div.className='suggestion-item';
div.innerText=item['COMPANY'];
div.onclick=()=>renderDetails(item);
suggestBox.appendChild(div);
});
}else{
suggestBox.style.display='none';
}
});

function renderDetails(person){
searchInput.value=person['COMPANY'];
suggestBox.style.display='none';
const container=document.getElementById('infoContainer');
container.innerHTML='';

function createSection(title,fields){
let section=document.createElement('div');
section.className='section-box';
let html=`<h3>${title}</h3><div class="section-grid">`;

fields.forEach(([label,key])=>{
let value=person[key]||"N/A";

if(label.toLowerCase().includes('date') && typeof value==='number'){
value=new Date((value-25569)*86400000).toLocaleDateString('en-GB');
}

html+=`
<div class="info-card">
<span class="label">${label}</span>
<span class="value">${value}</span>
</div>`;
});

html+=`</div>`;
section.innerHTML=html;
container.appendChild(section);
}

createSection("Company Information",[
["Company","COMPANY"],
["Designation","DESIGNATION"],
["Gate Pass Status","GATE PASS STATUS"]
]);

createSection("Personal Information",[
["Name","NAME"],
["Date of Birth","DATE OF BIRTH"],
["Blood Type","BLOOD TYPE"],
["Nationality","NATIONALITY"],
["Religion","RELIGION"],
["Gender","GENDER"]
]);

createSection("Iqama Information",[
["Iqama Number","IQAMA NO."],
["Issue Date","ISSUE DATE"],
["Expiry Date","EXPIRY DATE"]
]);

createSection("Passport Information",[
["Passport Number","PASSPORT NUMBER"],
["Place of Issue","PLACE OF ISSUE"],
["Issue Date","ISSUE DATE (PASSPORT)"],
["Expiry Date","EXPIRY DATE (PASSPORT)"]
]);

}

window.onload=loadExcel;

window.addEventListener('click',(e)=>{
if(!e.target.closest('.search-wrapper')){
suggestBox.style.display='none';
}
});

</script>

</body>
</html>
